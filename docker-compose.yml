version: '3.8'

services:
  zonescan:
    # Construye la imagen de Docker usando el Dockerfile en el directorio actual.
    build: .
    
    # Nombre del contenedor para fácil identificación.
    container_name: zonescan-app
    
    # Mapea el puerto 9002 del servidor (host) al puerto 3000 del contenedor
    # donde se ejecuta la aplicación Next.js.
    # Puedes acceder a la app en http://<ip_del_servidor>:9002
    ports:
      - "9002:3000"
      
    # Monta el archivo db.json desde el servidor al contenedor.
    # Esto asegura que los datos sean persistentes y no se pierdan al reiniciar el contenedor.
    # ¡Importante! Asegúrate de que exista un archivo db.json vacío en la misma carpeta
    # que este docker-compose.yml antes de iniciar por primera vez.
    volumes:
      - ./db.json:/app/db.json
      
    # Política de reinicio: siempre reinicia el contenedor si se detiene,
    # a menos que lo detengas explícitamente. Ideal para producción.
    restart: unless-stopped
    
    # Define las variables de entorno para el contenedor.
    environment:
      - NODE_ENV=production
      - PORT=3000
